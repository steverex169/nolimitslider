{% extends 'agent/template.html' %}

{% block content %}
<div class="main px-4 py-3">
    <h2 class="mb-4">ðŸ’¬ Chats â€” {% if session_type %}{{ session_type|title }}{% else %}All{% endif %}</h2>

    <!-- Summary Cards -->
    <div class="row g-3 mb-4">
        <div class="col-md-4">
            <div class="card shadow-sm text-center h-100 border-0">
                <div class="card-body">
                    <h6 class="text-muted">Total Chats</h6>
                    <h2 class="fw-bold text-primary">{{ all_chats.count }}</h2>
                    <a href="{% url 'agent_chats' %}" 
                       class="btn btn-outline-primary btn-sm mt-2">View All</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm text-center h-100 border-0">
                <div class="card-body">
                    <h6 class="text-muted">Active Chats</h6>
                    <h2 class="fw-bold text-success">{{ active_chats.count }}</h2>
                    <a href="{% url 'agent_chats' %}?type=active" 
                       class="btn btn-outline-success btn-sm mt-2">View Active</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm text-center h-100 border-0">
                <div class="card-body">
                    <h6 class="text-muted">New Chats</h6>
                    <h2 class="fw-bold text-warning">{{ new_chats.count }}</h2>
                    <a href="{% url 'agent_chats' %}?type=new" 
                       class="btn btn-outline-warning btn-sm mt-2">View New</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat List Section -->
    <div class="card shadow-sm border-0">
        <div class="card-header bg-light d-flex justify-content-between align-items-center">
            <h5 class="mb-0">ðŸ“‹ Chat List</h5>
            <span class="badge bg-secondary">{{ selected_chats.count }} found</span>
        </div>
        <div class="list-group list-group-flush">
            {% for chat in selected_chats %}
                <a href="{% url 'agent_chat' chat.session_id %}" 
                   class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                    <div>
                        <span class="fw-bold">#{{ chat.session_id }}</span>
                        â€” {{ chat.user_name|default:"Guest" }}
                    </div>
                    <small class="text-muted">{{ chat.created_at|date:"M d, H:i" }}</small>
                </a>
            {% empty %}
                <div class="list-group-item text-center text-muted py-4">
                    No chats found.
                </div>
            {% endfor %}
        </div>
    </div>
</div>

<style>
/* Extra polish */
.list-group-item {
    transition: all 0.2s ease-in-out;
    border-left: 4px solid transparent;
}
.list-group-item:hover {
    background-color: #f8f9fa;
    border-left: 4px solid #0d6efd;
}
.card {
    border-radius: 0.75rem;
}
</style>
{% endblock %}
